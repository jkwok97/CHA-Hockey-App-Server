
**** SELECT PLAYERS NAME AND SALARY ****

SELECT *
FROM players_v2
FULL OUTER JOIN salaries_v2
ON players_v2.id = salaries_v2.player_id
WHERE players_v2.id = '2';

UPDATE players_stats_v2
SET team_name = 'LOU'
WHERE id = '2';



SELECT 
a.*,
b.shortname,
b.city,
b.nickname,
b.teamlogo
FROM draft_order_v2 as a 
LEFT JOIN teams_v2 as b 
ON a.team_id = b.id
WHERE (19 in (team_id, round_one, round_two, round_three, round_four, round_five) AND (a.draft_year = '2020' OR a.draft_year = '2021'));



SELECT agents.agent_code,agents.agent_name,
SUM(orders.advance_amount)
FROM agents,orders
WHERE agents.agent_code=orders.agent_code
GROUP BY agents.agent_code,agents.agent_name
ORDER BY agents.agent_code;

select
b.firstname as firstname,
b.lastname as lastname,
b.isgoalie as isgoalie,
a.player_id as player_id,
a.season_type as season_type, 
a.team_name as team_name, 
sum(a.games_played) as games_played, 
sum(a.goals) as goals, 
sum(a.assists) as assists, 
sum(a.points) as points, 
sum(a.plus_minus) as plus_minus, 
sum(a.penalty_minutes) as penalty_minutes, 
sum(a.sh_goals) as sh_goals, 
sum(a.pp_goals) as pp_goals, 
sum(a.gw_goals) as gw_goals, 
sum(a.gt_goals) as gt_goals, 
sum(a.shots) as shots, 
sum(a.minutes_played) as minutes_played, 
sum(a.hits) as hits, 
sum(a.blocked_shots) as blocked_shots
from
players_stats_v2 as a
players_v2 as b
where a.player_id = b.id
and
a.team_name = 'STA'
AND
a.season_type = 'Regular'
group by b.firstname, b.lastname, b.isgoalie, a.player_id, a.season_type, a.team_name
;



select
b.firstname as firstname,
b.lastname as lastname,
b.isgoalie as isgoalie,
a.player_id as player_id,
a.season_type as season_type, 
a.team_name as team_name,
c.city as city, 
c.nickname as nickname,
c.teamlogo,
sum(a.games_played) as games_played, 
sum(a.goals) as goals, 
sum(a.assists) as assists, 
sum(a.points) as points, 
sum(a.plus_minus) as plus_minus, 
sum(a.penalty_minutes) as penalty_minutes, 
sum(a.sh_goals) as sh_goals, 
sum(a.pp_goals) as pp_goals, 
sum(a.gw_goals) as gw_goals, 
sum(a.gt_goals) as gt_goals, 
sum(a.shots) as shots, 
sum(a.minutes_played) as minutes_played, 
sum(a.hits) as hits, 
sum(a.blocked_shots) as blocked_shots
from
players_stats_v2 as a
left join players_v2 as b
on b.id = a.player_id
left join teams_v2 as c
on c.shortname = a.team_name
where (a.player_id = b.id
AND
a.season_type = 'Regular'
and
c.users_id = '18')
group by b.firstname, b.lastname, b.isgoalie, a.player_id, a.season_type, a.team_name, c.city, c.nickname, c.teamlogo
;

and
a.team_name = 'STA'









season_type as season_type, 
team_name as team_name, 
sum(games_played) as games_played, 
sum(goals) as goals, 
sum(assists) as assists, 
sum(points) as points, 
sum(plus_minus) as plus_minus, 
sum(penalty_minutes) as penalty_minutes, 
sum(sh_goals) as sh_goals, 
sum(pp_goals) as pp_goals, 
sum(gw_goals) as gw_goals, 
sum(gt_goals) as gt_goals, 
sum(shots) as shots, 
sum(minutes_played) as minutes_played, 
sum(hits) as hits, 
sum(blocked_shots) as blocked_shots, 
player_id
from players_stats_v2 as a
where team_name = 'STA' 
and 
season_type = 'Regular'
group by a.player_id, a.team_name, a.season_type;





-- 06-09-2020	To Oak: J. Roslovic To Sea: M. Wood, Oak 3rd

-- INSERT INTO transactions_v2
-- VALUES (
--     '1',
--     '2020-06-09',
--     '13',
--     '{}',
--     '{1399}',
--     '17',
--     '{"Oak 3rd"}',
--     '{1772}'
-- );

// select by id
select 
d.id,
d.team_one_id,
d.team_one_picks,
d.team_two_id,
d.team_two_picks,
d.transaction_date,
(select array_agg(p.firstname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = '1') as team_one_firstnames,
(select array_agg(p.lastname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = '1') as team_one_lastnames,
(select array_agg(p.nhl_id) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = '1') as team_one_nhlids,
(select array_agg(p.firstname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = '1') as team_two_firstnames,
(select array_agg(p.lastname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = '1') as team_two_lastname,
(select array_agg(p.nhl_id) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = '1') as team_two_nhlids
from transactions_v2 d
where d.id = '1'
group by d.id;

// select all
select 
d.id,
d.team_one_id,
d.team_one_picks,
d.team_two_id,
d.team_two_picks,
d.transaction_date,
(select array_agg(p.firstname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = d.id) as team_one_firstnames,
(select array_agg(p.lastname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = d.id) as team_one_lastnames,
(select array_agg(p.nhl_id) from transactions_v2 c left join players_v2 p on p.id = any(c.team_one_players) where c.id = d.id) as team_one_nhlids,
(select array_agg(p.firstname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = d.id) as team_two_firstnames,
(select array_agg(p.lastname) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = d.id) as team_two_lastname,
(select array_agg(p.nhl_id) from transactions_v2 c left join players_v2 p on p.id = any(c.team_two_players) where c.id = d.id) as team_two_nhlids
from transactions_v2 d;

==================================================================

INSERT INTO transactions_v2
VALUES (
    '3',
    '2020-06-05',
    '12',
    '{}',
    '{212}',
    '15',
    '{"SCS 1st 2020", "MSG 3rd 2021", "MSG 5th 2021"}',
    '{}'
);

To Msg: B. Burns To Peo: SC 1st, Msg 3rd (2021), Msg 5th (2021)

transaction_date: req.body.transaction_date,
team_one_id: req.body.team_one_id,
team_one_picks: req.body.team_one_picks,
team_one_players: req.body.team_one_players,
team_two_id: req.body.team_two_id,
team_two_picks: req.body.team_two_picks,
team_two_players: req.body.team_two_players

==================================================================